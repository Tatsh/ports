PortSystem          1.0
PortGroup           github 1.0
PortGroup           xcode 1.0

github.setup        munki munki 3.6.0 v

name                munki-status
version             3.6.0
maintainers         {gmail.com:audvare @Tatsh}
license             Apache-2
description         Managed software installation for macOS (MunkiStatus).
long_description    Munki is a set of tools that, used together with a webserver-based \
                    repository of packages and package metadata, can be used by macOS \
                    administrators to manage software installs (and in many cases removals) on \
                    macOS client machines.

checksums           rmd160  722828893a7a06bcd2cdb4f9d631072d33d39a27 \
                    sha256  c32fdb6d351444bf88cc0e0296dc2e43594def23e06f96937750f4661321f494 \
                    size    7442236

worksrcdir          "munki-${version}/code/apps/MunkiStatus"

xcode.configuration Release
xcode.build.settings \
    CODE_SIGN_IDENTITY=- \
    CODE_SIGN_STYLE=Manual

build {}

post-destroot {
    xinstall -d -m 755 "${destroot}/${applications_dir}/Managed Software Center.app/Contents/Resources/"
    file copy "${destroot}/${applications_dir}/MunkiStatus.app" \
        "${destroot}/${applications_dir}/Managed Software Center.app/Contents/Resources/"
    file delete -force ${destroot}/${applications_dir}/MunkiStatus.app
}

if {${os.major} < 16} {
    pre-fetch {
        ui_error "${name} @${version} requires OS X 10.12 or later."
        return -code error "incompatible OS X version"
    }
}
