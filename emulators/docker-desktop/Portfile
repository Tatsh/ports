# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0

name                docker-desktop
version             2.5.3
maintainers         {gmail.com:audvare @Tatsh}
license             Restricted
description         The fastest way to containerize applications on your desktop.
long_description    ${description}
platforms           macosx
categories          emulators aqua
homepage            https://www.docker.com/products/docker-desktop
master_sites        https://desktop.docker.com/mac/edge/50261/
distfiles           Docker.dmg

checksums           rmd160  bf2eaeb9aeb583fa46e32036d3c93b3bcc9d92c2 \
                    sha256  ea983addca3843f7589603deff3ee37476a2dc403ba8075b04599e31055b66ba \
                    size    527031803

livecheck.type      regex
livecheck.url       https://desktop.docker.com/mac/edge/appcast.xml
livecheck.regex     "<item><title>(\\d+\[^\\s\]+)"

use_configure       no
use_dmg             yes
extract.only        Docker.dmg
extract.mkdir       no

if {${os.major} < 18} {
    pre-fetch {
        ui_error "${name} @${version} requires OS X 10.14 or later."
        return -code error "incompatible OS X version"
    }
}

build {}

destroot {
    copy ${worksrcpath}/Docker.app ${destroot}${applications_dir}/
}

post-deactivate {
    ui_msg "To fully uninstall, run the following command:"
    ui_msg ""
    ui_msg "sudo rm \\"
    ui_msg "  /usr/local/bin/docker \\"
    ui_msg "  /usr/local/bin/notary \\"
    ui_msg "  /usr/local/bin/hyperkit \\"
    ui_msg "  /usr/local/bin/docker-credential-ecr-login \\"
    ui_msg "  /usr/local/bin/kubectl.docker \\"
    ui_msg "  /usr/local/bin/docker-credential-osxkeychain \\"
    ui_msg "  /usr/local/bin/vboximg-mount \\"
    ui_msg "  /usr/local/bin/docker-credential-desktop \\"
    ui_msg "  /usr/local/bin/com.docker.cli \\"
    ui_msg "  /usr/local/bin/vpnkit \\"
    ui_msg "  /usr/local/bin/docker-compose \\"
    ui_msg "  /usr/local/bin/hexf \\"
    ui_msg "  /usr/local/bin/kubectl \\"
    ui_msg "  /usr/local/lib/docker \\"
    ui_msg "  /usr/local/lib/docker/cli-plugins"
    ui_msg ""
}
