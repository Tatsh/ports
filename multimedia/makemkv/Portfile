PortSystem          1.0
PortGroup           github 1.0

set pv 1.14.3
set my_p "makemkv-oss-${pv}"
set my_pb "makemkv-bin-${pv}"

name                makemkv
version             ${pv}
description         Tool for ripping and streaming Blu-ray, HD-DVD and DVD discs.
long_description    ${description}
license             {LGPL-2.1 MPL-1.1 MakeMKV-EULA openssl}
categories          multimedia

master_sites        http://www.makemkv.com/download/:p \
                    http://www.makemkv.com/download/:pb
distfiles           ${my_p}.tar.gz:p \
                    ${my_pb}.tar.gz:pb
worksrcdir          ${my_p}

checksums           makemkv-oss-1.14.3.tar.gz \
                    rmd160  ef104c785a7cda22732a02f5bb00315589f01dcc \
                    sha256  222cf2dcfde7a84944353c7edd326e18e3d35b7a7e575484111f64a4b1b9fec9 \
                    size    4384183 \
                    makemkv-bin-1.14.3.tar.gz \
                    rmd160  b1201b13f76e3ff0896cf93de10e46d3ccdeba45 \
                    sha256  e0b10e94ea98643e05da009f867e58481e721fb5c0551d6e5aa2f7756f3e2bb4 \
                    size    9117659

depends_lib         port:expat \
                    port:openssl \
                    port:zlib \
                    port:ffmpeg \
                    port:qt5-kde
depends_run         port:ccextractor \
                    port:wget

configure.args-append LDFLAGS=-L${prefix}/lib/openssl-1.0 --disable-noec --disable-qt4

variant qt5 {
    configure.args-append --enable-gui --enable-qt5
}

default_variants    +qt5

patch {
    reinplace "s| -lrt||g" "${worksrcpath}/configure"
    reinplace "s| -D_linux_||g" "${worksrcpath}/Makefile.in"
}
